/** * Created by wolyshaw on 15/11/4. *///var mongoose = require('mongoose');var Client = require('easymysql');var table = 'test3';var mysql = Client.create({  'maxconnections' : 10});// 连接信息mysql.addserver({  'host' : '115.29.165.70',  'user' : 'abcdea',  'password' : 'sqlshaw1995',  'database' : 'test'});mysql.addserver({  'host' : '115.29.165.70',  'user' : 'abcdea',  'password' : 'sqlshaw1995',  'database' : 'test'});module.exports ={  nowTime : function (fmt){    // 时间格式化    Date.prototype.Format = function (fmt) {      var o = {        "M+": this.getMonth() + 1, //月份        "d+": this.getDate(), //日        "h+": this.getHours(), //小时        "m+": this.getMinutes(), //分        "s+": this.getSeconds(), //秒        "q+": Math.floor((this.getMonth() + 3) / 3), //季度        "S": this.getMilliseconds() //毫秒      };      if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));      for (var k in o)        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));      return fmt;    };    return new Date().Format(fmt);  },  getData:function(sql, fun){    mysql.query({      sql:sql,      params: {user: 'abcdea'}    }, fun);  },  upData:function(req, res){    mysql.query({      sql: 'INSERT INTO '+table+' SET title="'+req.body.title+'", link="'+req.body.link+'", synopsis="'+req.body.synopsis+'", cat="'+req.body.cat+'"',      params: {user: 'abcdea'}    }, function (err, rows) {      console.log(err);      console.log(rows)    });  }};//var wanSchema = new mongoose.Schema({//  title : String, // 标题//  link : String, // 链接,一般是原文链接//  more : String, // 详情,一般指内页详情//  content : String, // 内容,说明文字//  author : String, // 作者名称//  bgm : String, // 背景音乐//  time : Number, // 时间//  meta : {//    createDate : {//      type : Date, // 创建时间//      default : Date.now()//    },//    uploadDate : {//      type : Date, // 更新时间//      default : Date.now()//    }//  }//});////wanSchema.pre('save', function(next){//  if (this.isNew) {//    this.meta.createDate = this.meta.uploadDate = Date.now()//  } else {//    this.meta.uploadDate = Date.now()//  }//  next()//});////wanSchema.statice = {//  fetch : function(cb){//    return this//      .find({})//      .sort('meta.uploadDate')//      .exec(cb)//  },//  findhById : function(id, cb){//    return this//      .findOne({_id: id})//      .exec(cb)//  }//};////wan.exports = wanSchema;//module.exports = {//  one : function (){//    console.log('one')//  },//  two : function (){//    console.log('two')//  }//};// 链接信息//var mysql = require('mysql');//var conn = mysql.createConnection({//  host: '115.29.165.70',//  user: 'abcdea',//  password: 'sqlshaw1995',//  database:'test',//  port: 3306//});//var table = 'test';//// 时间格式化//Date.prototype.Format = function (fmt) {//  var o = {//    "M+": this.getMonth() + 1, //月份//    "d+": this.getDate(), //日//    "h+": this.getHours(), //小时//    "m+": this.getMinutes(), //分//    "s+": this.getSeconds(), //秒//    "q+": Math.floor((this.getMonth() + 3) / 3), //季度//    "S": this.getMilliseconds() //毫秒//  };//  if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));//  for (var k in o)//    if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));//  return fmt;//}//var ate=new Date().Format("yyyy-MM-dd hh:mm:ss");//console.log(ate)//// 需要数据类型//var data = {//  "username":"zhangsan00",//  "password":"123400",//  "created":ate//}//conn.connect();//// 创建表//var createSQL = 'CREATE TABLE '+table+' (id INT(11) AUTO_INCREMENT, username VARCHAR(255), password VARCHAR(255), created' +//  ' DATETIME, PRIMARY KEY (id))';//// 追加数据//var insertSQL = 'INSERT INTO '+table+' SET username="'+data.username+'", password="'+data.password+'", created="'+data.created+'"';//// 查询数据//var selectSQL = 'select * from '+table;//// 删除数据//var deleteSQL = 'delete from '+table;//// 更新数据//var updateSQL = 'update '+table+' set password = 456 where id = 3';//基本逻辑//打开检查是否是登陆用户